{% if page.metafields.custom.cat_logo_pdf != blank %}
  {% assign pdf_url = page.metafields.custom.cat_logo_pdf | file_url %}
{% else %}
  {% assign pdf_url = "" %}
{% endif %}

<!-- üìå Cargar Librer√≠as de DearFlip -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/dearhive/dearflip-css-js/css/dearflip.min.css">
<script src="https://cdn.jsdelivr.net/gh/dearhive/dearflip-css-js/js/dearflip.min.js"></script>

<!-- üìå Contenedor del FlipBook -->
<div id="flipbookContainer">
  {% if pdf_url != "" %}
    <div class="df3d" id="myFlipbook" source="{{ pdf_url }}"></div>
  {% else %}
    <p class="error-message">‚ö† No se encontr√≥ ning√∫n PDF. Verifica el metafield en Shopify.</p>
  {% endif %}
</div>

<!-- üìå Script para Inicializar el FlipBook -->
<script>
document.addEventListener("DOMContentLoaded", function () {
    setTimeout(() => {
        if (typeof DFLIP === "undefined") {
            console.error("‚ùå DearFlip no se ha cargado correctamente.");
            return;
        }

        const flipbookElement = document.getElementById("myFlipbook");

        if (!flipbookElement || !flipbookElement.getAttribute("source")) {
            console.error("‚ùå No se encontr√≥ el contenedor del FlipBook o la URL del PDF.");
            return;
        }

        console.log("üöÄ Inicializando DearFlip con PDF:", flipbookElement.getAttribute("source"));

        new DFLIP({
            source: flipbookElement.getAttribute("source"),
            webgl: true,  // Activar efecto 3D realista
            backgroundColor: "#ffffff",  // Fondo blanco
            controls: {
                zoomIn: true,
                zoomOut: true,
                fullScreen: true,
                download: true  // Activar bot√≥n de descarga
            }
        }, flipbookElement);
    }, 3000); // üî• Esperar 3 segundos para que Shopify cargue correctamente los scripts
});
</script>

<!-- üìå Estilos para el FlipBook -->
<style>
/* üìå Estilos para centrar el FlipBook */
#flipbookContainer {
  width: 100%;
  max-width: 800px;
  margin: auto;
  text-align: center;
}

/* üìå Ajustar el tama√±o del FlipBook */
.df3d {
  width: 100% !important;
  height: 600px !important;
}

/* üìå Mensaje de error */
.error-message {
  color: red;
  font-weight: bold;
  text-align: center;
  margin-top: 20px;
}
</style>
