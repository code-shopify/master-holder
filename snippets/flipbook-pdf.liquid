{% if page.metafields.custom.cat_logo_pdf != blank %}
  {% assign pdf_url = page.metafields.custom.cat_logo_pdf | file_url %}
{% else %}
  {% assign pdf_url = "" %}
{% endif %}

<!-- Cargar CSS y JS de DearFlip -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/dearflip@2.0.4/css/dearflip.min.css">
<script src="https://cdn.jsdelivr.net/npm/dearflip@2.0.4/js/dearflip.min.js"></script>

<!-- Contenedor del FlipBook -->
<div id="flipbookContainer">
  {% if pdf_url != "" %}
    <div class="df3d" id="myFlipbook" source="{{ pdf_url }}"></div>
  {% else %}
    <p class="error-message">⚠ No se encontró ningún PDF. Verifica el metafield en Shopify.</p>
  {% endif %}
</div>

<!-- Script para Inicializar el FlipBook -->
<script>
document.addEventListener("DOMContentLoaded", function () {
    const flipbookElement = document.getElementById("myFlipbook");
    
    if (flipbookElement && flipbookElement.getAttribute("source")) {
        new DFLIP({
            source: flipbookElement.getAttribute("source"),
            webgl: true,  // Activa el efecto 3D realista
            backgroundColor: "#ffffff",  // Fondo blanco
            controls: {
                zoomIn: true,
                zoomOut: true,
                fullScreen: true,
                download: true  // Habilita botón de descarga
            }
        }, flipbookElement);
    } else {
        console.error("❌ No se encontró el contenedor del FlipBook o el PDF.");
    }
});
</script>

<!-- Estilos para el FlipBook -->
<style>
/* Estilos para centrar el FlipBook */
#flipbookContainer {
  width: 100%;
  max-width: 800px;
  margin: auto;
  text-align: center;
}

/* Ajustar el tamaño del FlipBook */
.df3d {
  width: 100% !important;
  height: 600px !important;
}

/* Mensaje de error */
.error-message {
  color: red;
  font-weight: bold;
  text-align: center;
  margin-top: 20px;
}
</style>
